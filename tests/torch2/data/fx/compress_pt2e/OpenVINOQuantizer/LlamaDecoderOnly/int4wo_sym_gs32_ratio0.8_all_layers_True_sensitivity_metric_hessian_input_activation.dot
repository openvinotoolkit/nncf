strict digraph {
"0 attn_norm_weight" [id=0, type="get_attr"];
"1 mlp_norm_weight" [id=1, type="get_attr"];
"2 rope_cos" [id=2, type="get_attr"];
"3 rope_sin" [id=3, type="get_attr"];
"4 x_embed" [id=4, type=input];
"5 arange" [id=5, type=arange];
"6 _assert_tensor_metadata_default" [id=6, type="_assert_tensor_metadata"];
"7 to" [id=7, type=to];
"8 pow_1" [id=8, type=pow];
"9 mean" [id=9, type=mean];
"10 add" [id=10, type=add];
"11 rsqrt" [id=11, type=rsqrt];
"12 mul" [id=12, type=mul];
"13 _assert_tensor_metadata_default_1" [id=13, type="_assert_tensor_metadata"];
"14 to_1" [id=14, type=to];
"15 mul_1" [id=15, type=mul];
"16 q_proj_weight_updated_constant0" [id=16, type="get_attr"];
"17 symmetric_weights_decompressor_q_proj_weight_0" [id=17, type="call_module"];
"18 linear" [id=18, type=linear];
"19 view" [id=19, type=view];
"20 transpose" [id=20, type=transpose];
"21 k_proj_weight_updated_constant0" [id=21, type="get_attr"];
"22 symmetric_weights_decompressor_k_proj_weight_0" [id=22, type="call_module"];
"23 linear_1" [id=23, type=linear];
"24 view_1" [id=24, type=view];
"25 transpose_1" [id=25, type=transpose];
"26 v_proj_weight_updated_constant0" [id=26, type="get_attr"];
"27 symmetric_weights_decompressor_v_proj_weight_0" [id=27, type="call_module"];
"28 linear_2" [id=28, type=linear];
"29 view_2" [id=29, type=view];
"30 transpose_2" [id=30, type=transpose];
"31 index" [id=31, type=index];
"32 index_1" [id=32, type=index];
"33 mul_2" [id=33, type=mul];
"34 slice_1" [id=34, type=slice];
"35 slice_2" [id=35, type=slice];
"36 neg" [id=36, type=neg];
"37 cat" [id=37, type=cat];
"38 mul_3" [id=38, type=mul];
"39 add_1" [id=39, type=add];
"40 mul_4" [id=40, type=mul];
"41 slice_3" [id=41, type=slice];
"42 slice_4" [id=42, type=slice];
"43 neg_1" [id=43, type=neg];
"44 cat_1" [id=44, type=cat];
"45 mul_5" [id=45, type=mul];
"46 add_2" [id=46, type=add];
"47 scaled_dot_product_attention" [id=47, type="scaled_dot_product_attention"];
"48 transpose_3" [id=48, type=transpose];
"49 view_3" [id=49, type=view];
"50 o_proj_weight_updated_constant0" [id=50, type="get_attr"];
"51 symmetric_weights_decompressor_o_proj_weight_0" [id=51, type="call_module"];
"52 linear_3" [id=52, type=linear];
"53 add_3" [id=53, type=add];
"54 _assert_tensor_metadata_default_2" [id=54, type="_assert_tensor_metadata"];
"55 to_2" [id=55, type=to];
"56 pow_2" [id=56, type=pow];
"57 mean_1" [id=57, type=mean];
"58 add_4" [id=58, type=add];
"59 rsqrt_1" [id=59, type=rsqrt];
"60 mul_6" [id=60, type=mul];
"61 _assert_tensor_metadata_default_3" [id=61, type="_assert_tensor_metadata"];
"62 to_3" [id=62, type=to];
"63 mul_7" [id=63, type=mul];
"64 mlp_gate_proj_weight_updated_constant0" [id=64, type="get_attr"];
"65 asymmetric_weights_decompressor_mlp_gate_proj_weight_0" [id=65, type="call_module"];
"66 linear_4" [id=66, type=linear];
"67 silu" [id=67, type=silu];
"68 mlp_up_proj_weight_updated_constant0" [id=68, type="get_attr"];
"69 asymmetric_weights_decompressor_mlp_up_proj_weight_0" [id=69, type="call_module"];
"70 linear_5" [id=70, type=linear];
"71 mul_8" [id=71, type=mul];
"72 mlp_down_proj_weight_updated_constant0" [id=72, type="get_attr"];
"73 symmetric_weights_decompressor_mlp_down_proj_weight_0" [id=73, type="call_module"];
"74 linear_6" [id=74, type=linear];
"75 add_5" [id=75, type=add];
"76 output" [id=76, type=output];
"0 attn_norm_weight" -> "15 mul_1" [style=solid, label="(64,)"];
"1 mlp_norm_weight" -> "63 mul_7" [style=solid, label="(64,)"];
"2 rope_cos" -> "31 index" [style=solid, label="(1, 1, 128, 16)"];
"3 rope_sin" -> "32 index_1" [style=solid, label="(1, 1, 128, 16)"];
"4 x_embed" -> "6 _assert_tensor_metadata_default" [style=solid, label="(1, 3, 64)"];
"4 x_embed" -> "7 to" [style=solid, label="(1, 3, 64)"];
"4 x_embed" -> "53 add_3" [style=solid, label="(1, 3, 64)"];
"5 arange" -> "31 index" [style=solid, label="(3,)"];
"5 arange" -> "32 index_1" [style=solid, label="(3,)"];
"7 to" -> "8 pow_1" [style=solid, label="(1, 3, 64)"];
"7 to" -> "12 mul" [style=solid, label="(1, 3, 64)"];
"8 pow_1" -> "9 mean" [style=solid, label="(1, 3, 64)"];
"9 mean" -> "10 add" [style=solid, label="(1, 3, 1)"];
"10 add" -> "11 rsqrt" [style=solid, label="(1, 3, 1)"];
"11 rsqrt" -> "12 mul" [style=solid, label="(1, 3, 1)"];
"12 mul" -> "13 _assert_tensor_metadata_default_1" [style=solid, label="(1, 3, 64)"];
"12 mul" -> "14 to_1" [style=solid, label="(1, 3, 64)"];
"14 to_1" -> "15 mul_1" [style=solid, label="(1, 3, 64)"];
"15 mul_1" -> "18 linear" [style=solid, label="(1, 3, 64)"];
"15 mul_1" -> "23 linear_1" [style=solid, label="(1, 3, 64)"];
"15 mul_1" -> "28 linear_2" [style=solid, label="(1, 3, 64)"];
"16 q_proj_weight_updated_constant0" -> "17 symmetric_weights_decompressor_q_proj_weight_0" [style=solid, label="(2048, 1)"];
"17 symmetric_weights_decompressor_q_proj_weight_0" -> "18 linear" [style=solid, label="(64, 64)"];
"18 linear" -> "19 view" [style=solid, label="(1, 3, 64)"];
"19 view" -> "20 transpose" [style=solid, label="(1, 3, 4, 16)"];
"20 transpose" -> "33 mul_2" [style=solid, label="(1, 4, 3, 16)"];
"20 transpose" -> "34 slice_1" [style=solid, label="(1, 4, 3, 16)"];
"20 transpose" -> "35 slice_2" [style=solid, label="(1, 4, 3, 16)"];
"21 k_proj_weight_updated_constant0" -> "22 symmetric_weights_decompressor_k_proj_weight_0" [style=solid, label="(2048, 1)"];
"22 symmetric_weights_decompressor_k_proj_weight_0" -> "23 linear_1" [style=solid, label="(64, 64)"];
"23 linear_1" -> "24 view_1" [style=solid, label="(1, 3, 64)"];
"24 view_1" -> "25 transpose_1" [style=solid, label="(1, 3, 4, 16)"];
"25 transpose_1" -> "40 mul_4" [style=solid, label="(1, 4, 3, 16)"];
"25 transpose_1" -> "41 slice_3" [style=solid, label="(1, 4, 3, 16)"];
"25 transpose_1" -> "42 slice_4" [style=solid, label="(1, 4, 3, 16)"];
"26 v_proj_weight_updated_constant0" -> "27 symmetric_weights_decompressor_v_proj_weight_0" [style=solid, label="(2048, 1)"];
"27 symmetric_weights_decompressor_v_proj_weight_0" -> "28 linear_2" [style=solid, label="(64, 64)"];
"28 linear_2" -> "29 view_2" [style=solid, label="(1, 3, 64)"];
"29 view_2" -> "30 transpose_2" [style=solid, label="(1, 3, 4, 16)"];
"30 transpose_2" -> "47 scaled_dot_product_attention" [style=solid, label="(1, 4, 3, 16)"];
"31 index" -> "33 mul_2" [style=solid, label="(1, 1, 3, 16)"];
"31 index" -> "40 mul_4" [style=solid, label="(1, 1, 3, 16)"];
"32 index_1" -> "38 mul_3" [style=solid, label="(1, 1, 3, 16)"];
"32 index_1" -> "45 mul_5" [style=solid, label="(1, 1, 3, 16)"];
"33 mul_2" -> "39 add_1" [style=solid, label="(1, 4, 3, 16)"];
"34 slice_1" -> "37 cat" [style=solid, label="(1, 4, 3, 8)"];
"35 slice_2" -> "36 neg" [style=solid, label="(1, 4, 3, 8)"];
"36 neg" -> "37 cat" [style=solid, label="(1, 4, 3, 8)"];
"37 cat" -> "38 mul_3" [style=solid, label="(1, 4, 3, 16)"];
"38 mul_3" -> "39 add_1" [style=solid, label="(1, 4, 3, 16)"];
"39 add_1" -> "47 scaled_dot_product_attention" [style=solid, label="(1, 4, 3, 16)"];
"40 mul_4" -> "46 add_2" [style=solid, label="(1, 4, 3, 16)"];
"41 slice_3" -> "44 cat_1" [style=solid, label="(1, 4, 3, 8)"];
"42 slice_4" -> "43 neg_1" [style=solid, label="(1, 4, 3, 8)"];
"43 neg_1" -> "44 cat_1" [style=solid, label="(1, 4, 3, 8)"];
"44 cat_1" -> "45 mul_5" [style=solid, label="(1, 4, 3, 16)"];
"45 mul_5" -> "46 add_2" [style=solid, label="(1, 4, 3, 16)"];
"46 add_2" -> "47 scaled_dot_product_attention" [style=solid, label="(1, 4, 3, 16)"];
"47 scaled_dot_product_attention" -> "48 transpose_3" [style=solid, label="(1, 4, 3, 16)"];
"48 transpose_3" -> "49 view_3" [style=solid, label="(1, 3, 4, 16)"];
"49 view_3" -> "52 linear_3" [style=solid, label="(1, 3, 64)"];
"50 o_proj_weight_updated_constant0" -> "51 symmetric_weights_decompressor_o_proj_weight_0" [style=solid, label="(2048, 1)"];
"51 symmetric_weights_decompressor_o_proj_weight_0" -> "52 linear_3" [style=solid, label="(64, 64)"];
"52 linear_3" -> "53 add_3" [style=solid, label="(1, 3, 64)"];
"53 add_3" -> "54 _assert_tensor_metadata_default_2" [style=solid, label="(1, 3, 64)"];
"53 add_3" -> "55 to_2" [style=solid, label="(1, 3, 64)"];
"55 to_2" -> "56 pow_2" [style=solid, label="(1, 3, 64)"];
"55 to_2" -> "60 mul_6" [style=solid, label="(1, 3, 64)"];
"55 to_2" -> "75 add_5" [style=solid, label="(1, 3, 64)"];
"56 pow_2" -> "57 mean_1" [style=solid, label="(1, 3, 64)"];
"57 mean_1" -> "58 add_4" [style=solid, label="(1, 3, 1)"];
"58 add_4" -> "59 rsqrt_1" [style=solid, label="(1, 3, 1)"];
"59 rsqrt_1" -> "60 mul_6" [style=solid, label="(1, 3, 1)"];
"60 mul_6" -> "61 _assert_tensor_metadata_default_3" [style=solid, label="(1, 3, 64)"];
"60 mul_6" -> "62 to_3" [style=solid, label="(1, 3, 64)"];
"62 to_3" -> "63 mul_7" [style=solid, label="(1, 3, 64)"];
"63 mul_7" -> "66 linear_4" [style=solid, label="(1, 3, 64)"];
"63 mul_7" -> "70 linear_5" [style=solid, label="(1, 3, 64)"];
"64 mlp_gate_proj_weight_updated_constant0" -> "65 asymmetric_weights_decompressor_mlp_gate_proj_weight_0" [style=solid, label="(128, 64)"];
"65 asymmetric_weights_decompressor_mlp_gate_proj_weight_0" -> "66 linear_4" [style=solid, label="(128, 64)"];
"66 linear_4" -> "67 silu" [style=solid, label="(1, 3, 128)"];
"67 silu" -> "71 mul_8" [style=solid, label="(1, 3, 128)"];
"68 mlp_up_proj_weight_updated_constant0" -> "69 asymmetric_weights_decompressor_mlp_up_proj_weight_0" [style=solid, label="(128, 64)"];
"69 asymmetric_weights_decompressor_mlp_up_proj_weight_0" -> "70 linear_5" [style=solid, label="(128, 64)"];
"70 linear_5" -> "71 mul_8" [style=solid, label="(1, 3, 128)"];
"71 mul_8" -> "74 linear_6" [style=solid, label="(1, 3, 128)"];
"72 mlp_down_proj_weight_updated_constant0" -> "73 symmetric_weights_decompressor_mlp_down_proj_weight_0" [style=solid, label="(4096, 1)"];
"73 symmetric_weights_decompressor_mlp_down_proj_weight_0" -> "74 linear_6" [style=solid, label="(64, 128)"];
"74 linear_6" -> "75 add_5" [style=solid, label="(1, 3, 64)"];
"75 add_5" -> "76 output" [style=solid, label="(1, 3, 64)"];
}
