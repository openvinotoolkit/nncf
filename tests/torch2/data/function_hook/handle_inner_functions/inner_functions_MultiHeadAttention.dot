digraph {
rankdir=TB;
0 [label="{type: input|name: query|dtype: torch.float32|shape: (5, 2, 16)}", fillcolor="#adadad", fontcolor="#000000", shape=record, style="filled,rounded"];
1 [label="{type: input|name: key|dtype: torch.float32|shape: (5, 2, 16)}", fillcolor="#adadad", fontcolor="#000000", shape=record, style="filled,rounded"];
2 [label="{type: input|name: value|dtype: torch.float32|shape: (5, 2, 16)}", fillcolor="#adadad", fontcolor="#000000", shape=record, style="filled,rounded"];
3 [label="{type: function_call|op_name: /rand/0|fn_name: rand|args: [\n(48, 16),\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
4 [label="{type: function_call|op_name: /rand/1|fn_name: rand|args: [\n48,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
5 [label="{type: function_call|op_name: /rand/2|fn_name: rand|args: [\n(16, 16),\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
6 [label="{type: function_call|op_name: /rand/3|fn_name: rand|args: [\n16,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
13 [label="{type: function_call|op_name: /chunk/0|fn_name: chunk|args: [\nTensorMeta(dtype=torch.float32, shape=(48, 16)),\n3,\n]|kwargs: \{\}}", fillcolor="#caffbf", fontcolor="#000000", shape=record, style="filled,rounded"];
14 [label="{type: function_call|op_name: /chunk/1|fn_name: chunk|args: [\nTensorMeta(dtype=torch.float32, shape=(48,)),\n3,\n]|kwargs: \{\}}", fillcolor="#caffbf", fontcolor="#000000", shape=record, style="filled,rounded"];
15 [label="{type: function_call|op_name: /linear/0|fn_name: linear|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 2, 16)),\nTensorMeta(dtype=torch.float32, shape=(16, 16)),\nTensorMeta(dtype=torch.float32, shape=(16,)),\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
16 [label="{type: function_call|op_name: /linear/1|fn_name: linear|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 2, 16)),\nTensorMeta(dtype=torch.float32, shape=(16, 16)),\nTensorMeta(dtype=torch.float32, shape=(16,)),\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
17 [label="{type: function_call|op_name: /linear/2|fn_name: linear|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 2, 16)),\nTensorMeta(dtype=torch.float32, shape=(16, 16)),\nTensorMeta(dtype=torch.float32, shape=(16,)),\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
18 [label="{type: function_call|op_name: /view/0|fn_name: view|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 2, 16)),\n5,\n8,\n4,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
19 [label="{type: function_call|op_name: /transpose/0|fn_name: transpose|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 8, 4)),\n0,\n1,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
21 [label="{type: function_call|op_name: /view/1|fn_name: view|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 2, 16)),\n5,\n8,\n4,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
22 [label="{type: function_call|op_name: /transpose/1|fn_name: transpose|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 8, 4)),\n0,\n1,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
24 [label="{type: function_call|op_name: /view/2|fn_name: view|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 2, 16)),\n5,\n8,\n4,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
25 [label="{type: function_call|op_name: /transpose/2|fn_name: transpose|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 8, 4)),\n0,\n1,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
27 [label="{type: function_call|op_name: /mul/0|fn_name: mul|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 4)),\n0.5,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
28 [label="{type: function_call|op_name: /transpose/3|fn_name: transpose|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 4)),\n-2,\n-1,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
29 [label="{type: function_call|op_name: /bmm/0|fn_name: bmm|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 4)),\nTensorMeta(dtype=torch.float32, shape=(8, 4, 5)),\n]|kwargs: \{\}}", fillcolor="#ffc6ff", fontcolor="#000000", shape=record, style="filled,rounded"];
30 [label="{type: function_call|op_name: /softmax/0|fn_name: softmax|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 5)),\n]|kwargs: \{\ndim : -1\n_stacklevel : 3\ndtype : None\n\}}", fillcolor="#bdb2ff", fontcolor="#000000", shape=record, style="filled,rounded"];
31 [label="{type: function_call|op_name: /dropout/0|fn_name: dropout|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 5)),\n]|kwargs: \{\np : 0.1\ntraining : True\ninplace : False\n\}}", fillcolor="#bdb2ff", fontcolor="#000000", shape=record, style="filled,rounded"];
32 [label="{type: function_call|op_name: /bmm/1|fn_name: bmm|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 5)),\nTensorMeta(dtype=torch.float32, shape=(8, 5, 4)),\n]|kwargs: \{\}}", fillcolor="#ffc6ff", fontcolor="#000000", shape=record, style="filled,rounded"];
33 [label="{type: function_call|op_name: /transpose/4|fn_name: transpose|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 4)),\n0,\n1,\n]|kwargs: \{\}}", fillcolor="#a0c4ff", fontcolor="#000000", shape=record, style="filled,rounded"];
34 [label="{type: function_call|op_name: /contiguous/0|fn_name: contiguous|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 8, 4)),\n]|kwargs: \{\}}", fillcolor="#caffbf", fontcolor="#000000", shape=record, style="filled,rounded"];
35 [label="{type: function_call|op_name: /view/3|fn_name: view|args: [\nTensorMeta(dtype=torch.float32, shape=(5, 8, 4)),\n10,\n16,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
36 [label="{type: function_call|op_name: /linear/3|fn_name: linear|args: [\nTensorMeta(dtype=torch.float32, shape=(10, 16)),\nTensorMeta(dtype=torch.float32, shape=(16, 16)),\nTensorMeta(dtype=torch.float32, shape=(16,)),\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
37 [label="{type: function_call|op_name: /view/4|fn_name: view|args: [\nTensorMeta(dtype=torch.float32, shape=(10, 16)),\n5,\n2,\n16,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
38 [label="{type: function_call|op_name: /view/5|fn_name: view|args: [\nTensorMeta(dtype=torch.float32, shape=(8, 5, 5)),\n2,\n4,\n5,\n5,\n]|kwargs: \{\}}", fillcolor="#fdffb6", fontcolor="#000000", shape=record, style="filled,rounded"];
39 [label="{type: function_call|op_name: /mean/0|fn_name: mean|args: [\nTensorMeta(dtype=torch.float32, shape=(2, 4, 5, 5)),\n]|kwargs: \{\ndim : 1\n\}}", fillcolor="#b3fbdf", fontcolor="#000000", shape=record, style="filled,rounded"];
40 [label="{type: output|name: output_0|dtype: torch.float32|shape: (5, 2, 16)}", fillcolor="#adadad", fontcolor="#000000", shape=record, style="filled,rounded"];
41 [label="{type: output|name: output_1|dtype: torch.float32|shape: (2, 5, 5)}", fillcolor="#adadad", fontcolor="#000000", shape=record, style="filled,rounded"];
0 -> 15 [label="(5, 2, 16)\n0 → 0"];
1 -> 16 [label="(5, 2, 16)\n0 → 0"];
2 -> 17 [label="(5, 2, 16)\n0 → 0"];
3 -> 13 [label="(48, 16)\n0 → 0"];
4 -> 14 [label="(48,)\n0 → 0"];
5 -> 36 [label="(16, 16)\n0 → 1"];
6 -> 36 [label="(16,)\n0 → 2"];
13 -> 15 [label="(16, 16)\n0 → 1"];
13 -> 16 [label="(16, 16)\n1 → 1"];
13 -> 17 [label="(16, 16)\n2 → 1"];
14 -> 15 [label="(16,)\n0 → 2"];
14 -> 16 [label="(16,)\n1 → 2"];
14 -> 17 [label="(16,)\n2 → 2"];
15 -> 18 [label="(5, 2, 16)\n0 → 0"];
16 -> 21 [label="(5, 2, 16)\n0 → 0"];
17 -> 24 [label="(5, 2, 16)\n0 → 0"];
18 -> 19 [label="(5, 8, 4)\n0 → 0"];
19 -> 27 [label="(8, 5, 4)\n0 → 0"];
21 -> 22 [label="(5, 8, 4)\n0 → 0"];
22 -> 28 [label="(8, 5, 4)\n0 → 0"];
24 -> 25 [label="(5, 8, 4)\n0 → 0"];
25 -> 32 [label="(8, 5, 4)\n0 → 1"];
27 -> 29 [label="(8, 5, 4)\n0 → 0"];
28 -> 29 [label="(8, 4, 5)\n0 → 1"];
29 -> 30 [label="(8, 5, 5)\n0 → 0"];
30 -> 31 [label="(8, 5, 5)\n0 → 0"];
31 -> 32 [label="(8, 5, 5)\n0 → 0"];
31 -> 38 [label="(8, 5, 5)\n0 → 0"];
32 -> 33 [label="(8, 5, 4)\n0 → 0"];
33 -> 34 [label="(5, 8, 4)\n0 → 0"];
34 -> 35 [label="(5, 8, 4)\n0 → 0"];
35 -> 36 [label="(10, 16)\n0 → 0"];
36 -> 37 [label="(10, 16)\n0 → 0"];
37 -> 40 [label="(5, 2, 16)\n0 → 0"];
38 -> 39 [label="(2, 4, 5, 5)\n0 → 0"];
39 -> 41 [label="(2, 5, 5)\n0 → 0"];
}
